package mik:core@0.1.0;

/// Minimal handler interface - all types inline.
/// JSON/time/random moved to pure Rust in mik-sdk.
interface handler {
    /// HTTP methods.
    enum method {
        %get,
        %post,
        %put,
        %patch,
        %delete,
        %head,
        %options,
    }

    /// HTTP request data from the bridge.
    record request-data {
        method: method,
        /// Full request path including query string (e.g., "/users?page=1&limit=10").
        /// Use split('?') to separate path from query parameters.
        path: string,
        headers: list<tuple<string, string>>,
        body: option<list<u8>>,
    }

    /// HTTP response.
    record response {
        /// HTTP status code (100-599). Values outside this range are clamped to 500.
        status: u16,
        headers: list<tuple<string, string>>,
        body: option<list<u8>>,
    }

    /// Process an HTTP request and return a response.
    handle: func(req: request-data) -> response;
}
