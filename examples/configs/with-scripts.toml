# Configuration with JavaScript orchestration scripts
# Scripts can call WASM handlers via host.call()

[project]
name = "orchestrated-api"
version = "0.1.0"
description = "API with JS orchestration layer"

[server]
port = 3000
modules = "modules/"
scripts = "scripts/"              # Enable JS orchestration

# Script endpoints: /script/<name>
# Example: /script/checkout calls scripts/checkout.js

[composition]
http_handler = true

[tracing]
enabled = true
service_name = "orchestrated-api"

# Directory structure:
# project/
# ├── modules/
# │   ├── cart.wasm
# │   ├── inventory.wasm
# │   └── payment.wasm
# ├── scripts/
# │   └── checkout.js            # Orchestrates cart + inventory + payment
# └── mik.toml

# Example scripts/checkout.js:
# ```javascript
# export async function handle(request) {
#   // Call WASM handlers from JS
#   const cart = await host.call("cart", {
#     path: "/items",
#     method: "GET"
#   });
#
#   const inventory = await host.call("inventory", {
#     path: "/check",
#     method: "POST",
#     body: JSON.stringify(cart.items)
#   });
#
#   return {
#     status: 200,
#     body: JSON.stringify({ cart, inventory })
#   };
# }
# ```
